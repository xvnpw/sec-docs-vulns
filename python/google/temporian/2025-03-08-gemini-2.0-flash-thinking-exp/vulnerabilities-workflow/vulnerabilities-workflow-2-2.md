### 1. CSV Injection in `tp.from_csv`

- **Description:**
    1. An attacker crafts a malicious CSV file. This file contains specially crafted formulas in one or more cells, designed to be interpreted and executed by spreadsheet software (like Microsoft Excel or Google Sheets) when the CSV is opened.
    2. The victim, unaware of the malicious content, uses the `tp.from_csv` function in Temporian to load and process this attacker-supplied CSV file.
    3. If Temporian, or the underlying CSV parsing library it uses, does not sanitize or neutralize these formulas before processing the CSV data, and the processed data is later exported or used in a context where it might be opened in spreadsheet software (e.g., exported to another CSV, displayed in a table for manual review, etc.), the formulas will be active.
    4. When the victim opens the processed CSV file with a spreadsheet application, the application executes the injected formulas without warning, potentially leading to arbitrary command execution, data theft, or other malicious activities on the victim's system.

- **Impact:**
    - **High:** If exploited successfully, this vulnerability can lead to arbitrary command execution on the victim's machine when they open the processed CSV file in spreadsheet software. This can result in:
        - **Data Breach:** Sensitive information on the victim's system could be stolen.
        - **System Compromise:** The attacker could gain control of the victim's system, install malware, or perform other malicious actions.
        - **Data Manipulation:** Data processed by Temporian could be altered, leading to incorrect analysis or model training.

- **Vulnerability Rank:** High

- **Currently Implemented Mitigations:**
    - Based on the provided project files, there is **no explicit mention of CSV injection mitigation** in the documentation (README.md, CONTRIBUTING.md, RELEASE.md, docstring_guidelines.md, build.md, build_manylinux.sh, RELEASE.md, docs/mkdocs.yml, docs/src/CHANGELOG.md, docs/src/tutorials/index.md, docs/src/recipes/index.md, docs/src/reference/index.md, config/move_generated_files.sh, tools/build.md, tools/build_cleaner.py, tools/check_install.py, tools/CONTRIBUTING.md, tools/coverage.sh, tools/create_operator.py, tools/docstring_guidelines.md, tools/RELEASE.md, tools/run_notebooks.sh, tools/start_compile_docker.sh, tools/start_notebook.sh, pyproject.toml, config/build.py, config/setup.py, tools/assemble_pip_files.py, benchmark/benchmark_time.py, benchmark/profile_memory.sh, benchmark/profile_time.sh, benchmark/scripts/add_index.py, benchmark/scripts/basic.py, benchmark/scripts/sma.py, benchmark/scripts/sma.py, benchmark/scripts/sma.py, temporian/__init__.py, temporian/api/__init__.py, temporian/beam/__init__.py, temporian/beam/evaluation.py, temporian/beam/implementation_lib.py, temporian/beam/io/__init__.py, temporian/beam/io/csv.py, temporian/beam/io/dict.py, temporian/beam/io/np_array_coder.py, temporian/beam/io/tensorflow.py, temporian/beam/operators/__init__.py, temporian/beam/operators/base.py, temporian/beam/operators/binary/__init__.py, temporian/beam/operators/binary/arithmetic.py, temporian/beam/operators/binary/base.py, temporian/beam/operators/binary/logical.py, temporian/beam/operators/binary/relational.py, temporian/beam/operators/cast.py, temporian/beam/operators/combine.py, temporian/beam/operators/drop_index.py, temporian/beam/operators/filter.py, temporian/beam/operators/filter_empty_index.py, temporian/beam/operators/filter_moving_count.py, temporian/beam/operators/glue.py, temporian/beam/operators/lag.py, temporian/beam/operators/leak.py, temporian/beam/operators/prefix.py, temporian/beam/operators/propagate.py, temporian/beam/operators/rename.py, temporian/beam/operators/resample.py, temporian/beam/operators/scalar/__init__.py, temporian/beam/operators/scalar/arithmetic_scalar.py, temporian/beam/operators/scalar/base.py, temporian/beam/operators/scalar/relational_scalar.py, temporian/beam/operators/since_last.py, temporian/beam/operators/tick.py, temporian/beam/operators/tick_calendar.py, temporian/beam/operators/timestamps.py, temporian/beam/operators/unique_timestamps.py, temporian/beam/operators/until_next.py, temporian/beam/operators/where.py, temporian/beam/operators/window/__init__.py, temporian/beam/operators/window/base.py, temporian/beam/operators/window/moving_count.py, temporian/beam/operators/window/moving_max.py, temporian/beam/operators/window/moving_min.py, temporian/beam/operators/window/moving_product.py, temporian/beam/operators/window/moving_standard_deviation.py, temporian/beam/operators/window/moving_sum.py, temporian/beam/operators/window/simple_moving_average.py, temporian/beam/operators/window/test/test_base.py, temporian/beam/operators/window/test/test_cumprod.py, temporian/beam/operators/window/test/test_cumsum.py, temporian/beam/operators/window/test/test_moving_count.py, temporian/beam/operators/window/test/test_moving_max.py, temporian/beam/operators/window/test/test_moving_min.py, temporian/beam/operators/window/test/test_moving_product.py, temporian/beam/operators/window/test/test_moving_standard_deviation.py, temporian/beam/operators/window/test/test_moving_sum.py, temporian/beam/operators/window/test/test_simple_moving_average.py, temporian/beam/operators/window/test/window_test.py, temporian/beam/test/evaluation_test.py, temporian/beam/test/io_test.py, temporian/beam/test/np_array_coder_test.py, temporian/beam/test/utils.py, temporian/core/__init__.py, temporian/core/compilation.py, temporian/core/data/__init__.py, temporian/core/data/dtype.py, temporian/core/data/duration.py, temporian/core/data/duration_utils.py, temporian/core/data/event_set.py, temporian/core/data/node.py, temporian/core/data/plotter_base.py, temporian/core/data/plotter_bokeh.py, temporian/core/data/plotter.py, temporian/core/data/schema.py, temporian/core/data/test/__init__.py, temporian/core/data/test/plotter_test.py, temporian/core/data/test/event_set_test.py, temporian/core/data/test/dtype_test.py, temporian/core/data/test/io_test.py, temporian/core/data/test/schema_test.py, temporian/core/data/dtype_normalization.py, temporian/core/data/display_utils.py, temporian/core/dataclasses.py, temporian/core/evaluation.py, temporian/core/graph.py, temporian/core/operator_lib.py, temporian/core/operators/__init__.py, temporian/core/operators/base.py, temporian/core/operators/binary/__init__.py, temporian/core/operators/binary/arithmetic.py, temporian/core/operators/binary/base.py, temporian/core/operators/binary/logical.py, temporian/core/operators/binary/relational.py, temporian/core/operators/calendar/__init__.py, temporian/core/operators/calendar/base.py, temporian/core/operators/calendar/calendar_day_of_month.py, temporian/core/operators/calendar/calendar_day_of_week.py, temporian/core/operators/calendar/calendar_day_of_year.py, temporian/core/operators/calendar/calendar_hour.py, temporian/core/operators/calendar/calendar_iso_week.py, temporian/core/operators/calendar/calendar_minute.py, temporian/core/operators/calendar/calendar_month.py, temporian/core/operators/calendar/calendar_second.py, temporian/core/operators/calendar/calendar_year.py, temporian/core/operators/calendar/test/__init__.py, temporian/core/operators/calendar/test/test_base.py, temporian/core/operators/calendar/test/test_base_timezone.py, temporian/core/operators/calendar/test/test_calendar_day_of_month.py, temporian/core/operators/calendar/test/test_calendar_day_of_week.py, temporian/core/operators/calendar/test/test_calendar_day_of_year.py, temporian/core/operators/calendar/test/test_calendar_hour.py, temporian/core/operators/calendar/test/test_calendar_iso_week.py, temporian/core/operators/calendar/test/test_calendar_minute.py, temporian/core/operators/calendar/test/test_calendar_month.py, temporian/core/operators/calendar/test/test_calendar_year.py, temporian/core/operators/drop.py, temporian/core/operators/drop_index.py, temporian/core/operators/end.py, temporian/core/operators/enumerate.py, temporian/core/operators/filter.py, temporian/core/operators/filter_empty_index.py, temporian/core/operators/filter_moving_count.py, temporian/core/operators/fillna.py, temporian/core/operators/glue.py, temporian/core/operators/join.py, temporian/core/operators/lag.py, temporian/core/operators/leak.py, temporian/core/operators/map.py, temporian/core/operators/prefix.py, temporian/core/operators/propagate.py, temporian/core/operators/rename.py, temporian/core/operators/resample.py, temporian/core/operators/select.py, temporian/core/operators/select_index_values.py, temporian/core/operators/since_last.py, temporian/core/operators/tick.py, temporian/core/operators/tick_calendar.py, temporian/core/operators/timestamps.py, temporian/core/operators/unique_timestamps.py, temporian/core/operators/until_next.py, temporian/core/operators/where.py, temporian/core/operators/window/__init__.py, temporian/core/operators/window/base.py, temporian/core/operators/window/moving_count.py, temporian/core/operators/window/moving_max.py, temporian/core/operators/window/moving_min.py, temporian/core/operators/window/moving_product.py, temporian/core/operators/window/moving_standard_deviation.py, temporian/core/operators/window/moving_sum.py, temporian/core/operators/window/simple_moving_average.py, temporian/core/operators/window/test/__init__.py, temporian/core/operators/window/test/test_base.py, temporian/core/operators/window/test/test_cumprod.py, temporian/core/operators/window/test/test_cumsum.py, temporian/core/operators/window/test/test_moving_count.py, temporian/core/operators/window/test/test_moving_max.py, temporian/core/operators/window/test/test_moving_min.py, temporian/core/operators/window/test/test_moving_product.py, temporian/core/operators/window/test/test_moving_standard_deviation.py, temporian/core/operators/window/test/test_moving_sum.py, temporian/core/operators/window/test/test_simple_moving_average.py, temporian/core/operators/window/test/window_test.py, temporian/core/operators/scalar/__init__.py, temporian/core/operators/scalar/base.py, temporian/core/operators/scalar/arithmetic_scalar.py, temporian/core/operators/scalar/relational_scalar.py, temporian/core/operators/scalar/test/__init__.py, temporian/core/operators/scalar/test/test_arithmetic_scalar.py, temporian/core/operators/scalar/test/test_base.py, temporian/core/operators/scalar/test/test_relational_scalar.py, temporian/core/operators/test/__init__.py, temporian/core/operators/test/test_add_index.py, temporian/core/operators/test/test_arithmetic.py, temporian/core/operators/test/test_base.py, temporian/core/operators/test/test_begin.py, temporian/core/operators/test/test_cast.py, temporian/core/operators/test/test_combine.py, temporian/core/operators/test/test_drop.py, temporian/core/operators/test/test_drop_index.py, temporian/core/operators/test/test_end.py, temporian/core/operators/test/test_enumerate.py, temporian/core/operators/test/test_fast_fourier_transform.py, temporian/core/operators/test/test_filter.py, temporian/core/operators/test/test_filter_empty_index.py, temporian/core/operators/test/test_filter_moving_count.py, temporian/core/operators/test/test_glue.py, temporian/core/operators/test/test_lag.py, temporian/core/operators/test/test_leak.py, temporian/core/operators/test/test_map.py, temporian/core/operators/test/test_prefix.py, temporian/core/operators/test/test_propagate.py, temporian/core/operators/test/test_relational.py, temporian/core/operators/test/test_relational_scalar.py, temporian/core/operators/test/test_rename.py, temporian/core/operators/test/test_resample.py, temporian/core/operators/test/test_select.py, temporian/core/operators/test/test_select_index_values.py, temporian/core/operators/test/test_since_last.py, temporian/core/operators/test/test_tick.py, temporian/core/operators/test/test_tick_calendar.py, temporian/core/operators/test/test_timestamps.py, temporian/core/operators/test/test_unique_timestamps.py, temporian/core/operators/test/test_until_next.py, temporian/core/operators/test/test_where.py, temporian/core/proto/__init__.py, temporian/core/schedule.py, temporian/core/serialization.py, temporian/core/test/__init__.py, temporian/core/test/compilation_test.py, temporian/core/test/evaluation_test.py, temporian/core/test/graph_test.py, temporian/core/test/magic_methods_test.py, temporian/core/test/operator_test.py, temporian/core/test/registered_operators_test.py, temporian/core/test/utils.py, temporian/core/types.py, temporian/implementation/__init__.py, temporian/implementation/numpy/__init__.py, temporian/implementation/numpy/data/__init__.py, temporian/implementation/numpy/data/dtype_normalization.py, temporian/implementation/numpy/data/event_set.py, temporian/implementation/numpy/data/display_utils.py, temporian/implementation/numpy/data/io.py, temporian/implementation/numpy/data/plotter.py, temporian/implementation/numpy/data/plotter_base.py, temporian/implementation/numpy/data/plotter_bokeh.py, temporian/implementation/numpy/data/test/__init__.py, temporian/implementation/numpy/data/test/io_test.py, temporian/implementation/numpy/data/test/plotter_test.py, temporian/implementation/numpy/evaluation.py, temporian/implementation/numpy/implementation_lib.py, temporian/implementation/numpy/operators/__init__.py, temporian/implementation/numpy/operators/base.py, temporian/implementation/numpy/operators/binary/__init__.py, temporian/implementation/numpy/operators/binary/arithmetic.py, temporian/implementation/numpy/operators/binary/base.py, temporian/implementation/numpy/operators/binary/logical.py, temporian/implementation/numpy/operators/binary/relational.py, temporian/implementation/numpy/operators/cast.py, temporian/implementation/numpy/operators/combine.py, temporian/implementation/numpy/operators/drop_index.py, temporian/implementation/numpy/operators/filter.py, temporian/implementation/numpy/operators/filter_empty_index.py, temporian/implementation/numpy/operators/filter_moving_count.py, temporian/implementation/numpy/operators/glue.py, temporian/implementation/numpy/operators/join.py, temporian/implementation/numpy/operators/lag.py, temporian/implementation/numpy/operators/leak.py, temporian/implementation/numpy/operators/map.py, temporian/implementation/numpy/operators/prefix.py, temporian/implementation/numpy/operators/propagate.py, temporian/implementation/numpy/operators/rename.py, temporian/implementation/numpy/operators/resample.py, temporian/implementation/numpy/operators/select.py, temporian/implementation/numpy/operators/select_index_values.py, temporian/implementation/numpy/operators/since_last.py, temporian/implementation/numpy/operators/tick.py, temporian/implementation/numpy/operators/tick_calendar.py, temporian/implementation/numpy/operators/timestamps.py, temporian/implementation/numpy/operators/unique_timestamps.py, temporian/implementation/numpy/operators/unary.py, temporian/implementation/numpy/operators/until_next.py, temporian/implementation/numpy/operators/where.py, temporian/implementation/numpy/operators/window/__init__.py, temporian/implementation/numpy/operators/window/base.py, temporian/implementation/numpy/operators/window/moving_count.py, temporian/implementation/numpy/operators/window/moving_max.py, temporian/implementation/numpy/operators/window/moving_min.py, temporian/implementation/numpy/operators/window/moving_product.py, temporian/implementation/numpy/operators/window/moving_standard_deviation.py, temporian/implementation/numpy/operators/window/moving_sum.py, temporian/implementation/numpy/operators/window/simple_moving_average.py, temporian/implementation/numpy/operators/window/test/__init__.py, temporian/implementation/numpy/operators/window/test/test_base.py, temporian/implementation/numpy/operators/window/test/test_cumprod.py, temporian/implementation/numpy/operators/window/test/test_cumsum.py, temporian/implementation/numpy/operators/window/test/test_moving_count.py, temporian/implementation/numpy/operators/window/test/test_moving_max.py, temporian/implementation/numpy/operators/window/test/test_moving_min.py, temporian/implementation/numpy/operators/window/test/test_moving_product.py, temporian/implementation/numpy/operators/window/test/test_moving_standard_deviation.py, temporian/implementation/numpy/operators/window/test/test_moving_sum.py, temporian/implementation/numpy/operators/window/test/test_simple_moving_average.py, temporian/implementation/numpy/operators/window/test/window_test.py, temporian/implementation/numpy/operators/scalar/__init__.py, temporian/implementation/numpy/operators/scalar/base.py, temporian/implementation/numpy/operators/scalar/arithmetic_scalar.py, temporian/implementation/numpy/operators/scalar/relational_scalar.py, temporian/implementation/numpy_operators/scalar/test/__init__.py, temporian/implementation/numpy/operators/scalar/test/test_arithmetic_scalar.py, temporian/implementation/numpy/operators/scalar/test/test_base.py, temporian/implementation/numpy/operators/scalar/test/test_relational_scalar.py, temporian/implementation/numpy_cc/__init__.py, temporian/implementation/numpy_cc/operators/__init__.py, temporian/io/__init__.py, temporian/io/csv.py, temporian/io/format.py, temporian/io/numpy.py, temporian/io/pandas.py, temporian/io/parquet.py, temporian/io/polars.py, temporian/io/tensorflow.py, temporian/io/test/__init__.py, temporian/io/test/csv_test.py, temporian/io/test/parquet_test.py, temporian/io/test/polars_test.py, temporian/io/test/tensorflow_test.py, temporian/proto/__init__.py, temporian/test/__init__.py, temporian/test/api_beam_test.py, temporian/test/api_test.py, temporian/test/doc_test.py, temporian/test/public_api_test.py, temporian/test/test_utils.py, temporian/test/utils.py, tools/__init__.py, tools/assemble_pip_files.py, tools/build.bat, tools/build.md, tools/build_cleaner.py, tools/build_cleaner_test.py, tools/build_manylinux.sh, tools/check_install.py, tools/CONTRIBUTING.md, tools/coverage.sh, tools/create_operator.py, tools/docstring_guidelines.md, tools/RELEASE.md, tools/run_notebooks.sh, tools/start_compile_docker.sh, tools/start_notebook.sh, tools/test/__init__.py, tools/test/check_install_test.py] and no specific mitigations are mentioned for CSV injection.

- **Missing Mitigations:**
    - **Input Sanitization:** Implement robust input sanitization within the `tp.from_csv` function. This should involve:
        - **Formula Detection:** Use regular expressions or dedicated libraries to identify potential formula injections (e.g., cells starting with '=', '@', '+', '-').
        - **Formula Neutralization:**  Prefix detected formulas with a character like a single quote (`'`) to prevent spreadsheet applications from executing them. Alternatively, remove or escape potentially harmful characters.
    - **User Warnings:**  When reading CSV files, especially from untrusted sources, issue a warning to the user about the potential risks of CSV injection and advise them to inspect the CSV content and sanitize it if necessary before using `tp.from_csv`. This warning should be part of the function's documentation and potentially logged during function execution for CSV files from external sources.
    - **Security Test Cases:** Add comprehensive security test cases specifically targeting CSV injection vulnerabilities in the test suite. These tests should cover various injection payloads and ensure that the mitigations are effective.

- **Preconditions:**
    - The attacker needs to provide a malicious CSV file to the victim.
    - The victim must use the `tp.from_csv` function to load this malicious CSV file.
    - The processed data from Temporian (or the original data if no processing is done) must be exported or used in a way that it can be opened by spreadsheet software.
    - The victim must open the processed CSV file using spreadsheet software that automatically executes formulas (e.g., Excel, Google Sheets, LibreOffice Calc).

- **Source Code Analysis:**
    - **File: /code/temporian/__init__.py:** This file exposes the `from_csv` function as part of the public API: `from temporian.io.csv import from_csv`.
    - **File: /code/temporian/io/csv.py:** This file likely contains the implementation of `from_csv`. However, the code for CSV parsing and sanitization logic is not included in the provided files.

    ```python
    # Example usage from /code/README.md
    import temporian as tp

    # Load sale transactions
    sales = tp.from_csv("sales.csv") # Potential vulnerability point
    ```

    - **Assumption:**  `tp.from_csv` likely uses standard Python CSV parsing libraries (like `csv.reader` or `pandas.read_csv`). Without specific sanitization, these libraries are vulnerable to CSV injection.

- **Security Test Case:**
    1. **Craft Malicious CSV:** Create a CSV file named `malicious.csv` with the following content:

    ```csv
    timestamp,feature1
    1,"=SYSTEM(\"calc\")"
    2,"normal_data"
    ```
    (Note: `=SYSTEM("calc")` is a common CSV injection payload for command execution in Excel. The exact payload may vary depending on the spreadsheet software.)

    2. **Load CSV with Temporian:** Write a Python script to load `malicious.csv` using `tp.from_csv`:

    ```python
    import temporian as tp

    malicious_evset = tp.from_csv("malicious.csv")
    # Export to another CSV or use daily_revenue.to_pandas() and save as CSV
    tp.to_csv(malicious_evset, "output.csv")
    print("CSV processed and saved as output.csv")
    ```

    3. **Execute Test Script:** Run the Python script. This will process the `malicious.csv` file and create `output.csv`.

    4. **Open `output.csv` in Spreadsheet Software:** Open `output.csv` (generated in step 3) using a vulnerable spreadsheet application like Microsoft Excel or Google Sheets.

    5. **Verify Vulnerability:** If the vulnerability exists, opening `output.csv` should trigger the execution of the injected formula, e.g., by opening a calculator application (as intended by `=SYSTEM("calc")`). If a calculator application opens, it confirms CSV injection vulnerability.

This test case demonstrates a basic CSV injection. More sophisticated test cases can be created with different payloads and scenarios.